{% comment %} Need to make changes here {% endcomment %}
{% for semyear,sem_marks in chartdict.items %}
var xValues = [
{% for sem_mark in sem_marks %}"{{sem_mark.sub_code}}",{% endfor %}
];
var ia1Values = [{% if sem_mark.exam == 'IA1' %}{{sem_mark.marks}}{% else %}0{% endif %},];
var ia2Values = [{% if sem_mark.exam == 'IA2' %}{{sem_mark.marks}}{% else %}0{% endif %},];
var eseValues = [{% if sem_mark.exam == 'ESE' %}{{sem_mark.marks}}{% else %}0{% endif %},];

var ia1Color = ["#FA1E0E", "#FFCA03", "#42E6A4", "#3EDBF0", "#C355F5"];
var ia2Color = ["#BD2000", "#FF5403", "#02A8A8", "#77ACF1", "#AA26DA"];
var eseColor = ["#8C0000", "#F90716", "#018383", "#04009A", "#851DE0"];

// horizontal bar chart 1
new Chart("barGraphSem1", {
  type: "horizontalBar",
  data: {
    labels: xValues,
    datasets: [
      {
        backgroundColor: ia1Color,
        data: ia1Values,
      },
      {
        backgroundColor: ia2Color,
        data: ia2Values,
      },
      {
        backgroundColor: eseColor,
        data: eseValues,
      },
    ],
  },
  options: {
    responsive: true,
    legend: { display: false },
    title: {
      position: "bottom",
      display: true,
      text: "Semester 1",
    },
    scales: {
      xAxes: [
        {
          stacked: true,
          ticks: { min: 0, max: 100 },
        },
      ],
      yAxes: [
        {
          display: false,
          stacked: true,
        },
      ],
    },
  },
});
{% endfor %}

// doughtnut 1
{% for semyear,sem_marks in chartdict.items %}
var xValues = [{% for sem_mark in sem_marks %}{% if sem_mark.exam == 'ESE' %}"{{sem_mark.sub_code}}",{% endif %}{% endfor %}];
var yValues = [{% for sem_mark in sem_marks %}{% if sem_mark.exam == 'ESE' %}{{sem_mark.marks}},{% endif %}{% endfor %}];
var barColors = ["#8C0000", "#F90716", "#018383", "#04009A", "#851DE0"];

var stackedText = {
  id: "stackedText",
  afterDatasetsDraw(chart, args, options) {
    const {
      ctx,
      data,
      chartArea: { top, bottom, left, right, width, height },
    } = chart;
    ctx.save();
    ctx.font = "bolder 13px Arial";
    // ctx.fillStyle = localStorage.getItem('theme') == 'dark' ?"#e5e9f0":"#111318";
    ctx.textAlign = "center";
    ctx.fillText("5.56", (left + right) / 2, (bottom + top) / 2 - 5);
    ctx.restore();

    ctx.font = "bold 8px Arial";
    // ctx.fillStyle = localStorage.getItem('theme') == 'dark' ?"#e5e9f0":"#111318";
    ctx.textAlign = "center";
    ctx.fillText("CGPA", (left + right) / 2, (bottom + top) / 2 + 5);
  },
};

new Chart("donut{{semyear}}", {
  type: "doughnut",
  data: {
    labels: xValues,
    datasets: [
      {
        backgroundColor: barColors,
        data: yValues,
      },
    ],
  },
  maintainAspectRatio: false,
  plugins: [stackedText],
});
{% endfor %}